generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Guild {
  id                      BigInt                   @unique
  verificationSubmissions VerificationSubmission[]
}

model VerificationSubmission {
  reference              String             @id @unique
  userId                 BigInt
  data                   Json
  timestamp              DateTime
  status                 VerificationStatus
  reviewMessageId        BigInt
  reviewMessageChannelId BigInt
  reviewMessageDeleted   Boolean            @default(false)
  followUpChannelId      BigInt?
  guildId                BigInt
  raiseMessageId         BigInt?
  raiseThreadId          BigInt?
  guild                  Guild              @relation(fields: [guildId], references: [id])
}

enum VerificationStatus {
  PENDING // Waiting review
  RAISED // Escalated to another level 
  FOLLOWUP // Waiting for followup
  APPROVED // Application approved 
  BANNED // User denied (banned)
  DENIED // Application denied 
  LAPSED // Application lapsed (user left server)
}
